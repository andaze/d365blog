---
title:  "Dynamics 365 のレポート機能でデータ分析を行う"
draft: false
weight: 18
datetitle: "2017.08.23 | "
showinhome: true
showinaccordian: true
rightMenu: "artical"
indexImg: "artical18.jpg"
description: "Dynamics 365 では、レポート ウィザードを使って、フェッチベースのレポートを生成することができます。ユーザーが簡易にデータを収集して分析する際に利用できる機能です。"
jsonld: {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": "Article headline",
      "image": [
        "https://example.com/photos/1x1/photo.jpg",
        "https://example.com/photos/4x3/photo.jpg",
        "https://example.com/photos/16x9/photo.jpg"
       ],
      "datePublished": "2015-02-05T08:00:00+08:00",
      "dateModified": "2015-02-05T09:20:00+08:00",
      "author": {
        "@type": "Person",
        "name": "John Doe"
       },
       "publisher": {
        "@type": "Organization",
        "name": "Google",
        "logo": {
          "@type": "ImageObject",
          "url": "https://google.com/logo.jpg"
         }
       }
    }
---
{{< detailTopImage >}}
{{< authorImage src="authorimage.jpg" name="Takafumi Noguchi" linkdin="https://www.linkedin.com/in/tnoguchi1123531" >}}

<!-- Intro  -->
Dynamics 365 では、レポート ウィザードを使って、フェッチベースのレポートを生成することができます。ユーザーが簡易にデータを収集して分析する際に利用できる機能です。

## レポートの作成方法
レポートの作成は簡易です。まずメニューから「レポート」をクリックします。
<!-- Image= report1.jpg -->
{{< imagedisplay src="report1.jpg" >}}

「＋新規」ボタンで新しいレポートを作成しましょう。
<!-- Image= report2.jpg -->
{{< imagedisplay src="report2.jpg" >}}

「レポートウィザード」をクリックして、レポート作成を開始します。
<!-- Image= report3.jpg -->
{{< imagedisplay src="report3.jpg" >}}

新しいレポートを作成するのであれば、「新しいレポートを開始する」にチェックを入れて「次へ」をクリックします。
<!-- Image= report4.jpg -->
{{< imagedisplay src="report4.jpg" >}}

もし既存のレポートをベースに別のレポートを作成する場合は、「既存のレポートから開始する」にチェックをいれて、「次へ」をクリックします。これは、同じようなレポートを複数作成する場合、例えば、都道府県別のレポートを作成する場合や、部署ごとに分けて同じレポートを作成する場合に便利です。
<!-- Image= report5.jpg -->
{{< imagedisplay src="report5.jpg" >}}

レポート名や説明を入力したら、「プライマリ レコードの種類」を選択します。これは、どのエンティティのレポートを作成したいかと決める項目です。

「関連するレコードの種類」という箇所には、そのプライマリで選択したエンティティに関連する他エンティティを選択できます。

例えば、”活動” エンティティを選択して、活動のエンティティは、「関連する企業名」という検索フィールドで、取引先企業エンティティと関連しているとします。この場合、「関連するレコードの種類」で “取引先企業” を 「関連する企業名」というフィールドを利用してレポートにすることができます。これにより、活動と企業のデータでレポートが作成できることになります。

今回の手順では、「プライマリ レコードの種類」だけを選択して「次へ」をクリックします。
<!-- Image= report6.jpg -->
{{< imagedisplay src="report6.jpg" >}}

フィルター条件を選択します。ここでは、活動の「活動の種類」が “レター” のデータのみを結果に表示させます。このフィルター条件では、活動に関連する上位下位どちらのエンティティのフィールドも条件に追加することができます。
<!-- Image= report7.jpg -->
{{< imagedisplay src="report7.jpg" >}}

レイアウトを作成します。右パネルの「タスク」では、追加した列の位置を変更したり、列の並び替え（降順・昇順）を変更したり、列の幅の変更や列の追加や削除などを行うこともできます。     
まずは、レポートの列に、エンティティのフィールドを追加しましょう。「列を追加するときはここをクリックします」にて列を追加します。
<!-- Image= report8.jpg -->
{{< imagedisplay src="report8.jpg" >}}

ここでは、列に「活動」の「件名」フィールドを、100ピクセルで追加します。
<!-- Image= report9.jpg -->
{{< imagedisplay src="report9.jpg" >}}

すべての列を追加し終えたら、「次へ」をクリックします。
<!-- Image= report10.jpg -->
{{< imagedisplay src="report10.jpg" >}}

「テーブルのみを表示する」にチェックをいれて、「次へ」をクリックします。
<!-- Image= report11.jpg -->
{{< imagedisplay src="report11.jpg" >}}

確認画面で「次へ」をクリックして、「完了」ボタンでウィザードは完了です。

すると、活動のレポートが作成されました。細かい設定周りについては、また別の機会で触れようと思いますが、これでレポートは作成されました。結果を表示させる場合は、「レポートの実行」をクリックします。
<!-- Image= report12.jpg -->
{{< imagedisplay src="report12.jpg" >}}

レポートの結果が表示されました。
<!-- Image= report13.jpg -->
{{< imagedisplay src="report13.jpg" >}}

これでレポートは利用することができるようになります。

## レポート機能の制限
レポート ウィザードで作成するレポートは、非開発ユーザーでも簡単に作成できるため便利ですが、いくつかの制限が存在します。

### 列に追加できるエンティティは上位1レベルのエンティティまで
これはどういうことかというと、(1) 取引先企業（担当者）> (2) 営業案件 > (3) 活動 という 3 階層のエンティティがあったとして、活動をプライマリーのレポートとすると、取得できるデータは、(2) の営業案件までです。

ただし、活動の場合は、「関連先」というフィールドが、(1) 取引先企業（担当者）を設定できるフィールドでもあるため、活動の中で、取引先企業を直接参照していれば、レポートに取得することはできます。これは活動から見て、取引先企業が、１レベル上位のエンティティになるからです。

例えば、
* 企業名：テスト株式会社
* 営業案件名：サブスクリプション販売 – テスト株式会社様      
  →　企業名　というフィールドで、テスト株式会社 を参照     
* 活動：電話     
  →   関連先 というフィールドで、サブスクリプション販売 – テスト株式会社様 を参照

という状況だとして、(3) 活動をベースのレポートを作成します。この時、レポートの列を追加する際、(2) 営業案件名　のフィールドを参照して、レポートの列に設定はできます。ただ、(1) 企業名 のフィールドについては、2レベル上位のため、列に設定できません。

しかし、以下の例では、

* 企業名：テスト株式会社2
* 活動：メールを送信

→   関連先 というフィールドで、テスト株式会社2 を参照

活動からみて、1レベル上位は、(1) 企業名のため、取引先企業のフィールドを、活動のレポートに列として追加することができます。

### レポートの列幅は最大 960ピクセルまで
レポートで列を複数追加でき、列幅を設定できるのですが、レポートの列幅の最大値は960ピクセルという制限があります。そのため、960ピクセルを超える場合、自動で列幅の調整がされます。
<!-- Image= report14.jpg -->
{{< imagedisplay src="report14.jpg" >}}

### 50,000 行以上のレポートは出力できない
これはレポートの制限になりますが、50,000行以上のレポートを出力しようとすると、「レコード数の上限を超えています。 レコード数を減らしてください。」というメッセージが表示され、エラーとなります。この場合は、レポートのフィルター条件で、件数を分割して処理する必要があります。

同様に、レポート出力後に「エクスポート」を行う際、Excel 形式でのエクスポートでも同じように処理できないことがあります。この場合は、csv 形式にしてエクスポートする必要があります。

詳しくは以下を参照してください。     
[Microsoft Dynamics 365 (オンライン) レポートに関する考慮事項](https://technet.microsoft.com/ja-jp/library/dn792525.aspx)

高度なレポートを生成したい場合は..

もし上記制限を超えるようなレポートを Dynamics 365 で生成したい場合は、SQL Server データ ツールと Visual Studio を使ってレポートをカスタマイズするか、Power BI を使ったデータ分析を行う必要があります。

[SQL Server Data Tools を使用してレポートを新規作成する](https://technet.microsoft.com/ja-jp/library/dn531151.aspx)

[Microsoft Dynamics 365 での Power BI の使用](https://technet.microsoft.com/ja-jp/library/dn708055.aspx)

この方法についても、今後の記事で取り上げていきたいと思います。

今回はこれまで。