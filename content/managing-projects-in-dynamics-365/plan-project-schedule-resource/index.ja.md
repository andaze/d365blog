---
title:  "Project Service でプロジェクトを計画"
draft: false
weight: 4
datetitle: "2017.08.23 | "
showinhome: true
showinaccordian: false
rightMenu: "artical"
indexImg: "artical4.jpg"
description: "前回[プロジェクトの作成]()が完了したので、今度はプロジェクトの中身を埋めていきましょう。"
jsonld: {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": "Article headline",
      "image": [
        "https://example.com/photos/1x1/photo.jpg",
        "https://example.com/photos/4x3/photo.jpg",
        "https://example.com/photos/16x9/photo.jpg"
       ],
      "datePublished": "2015-02-05T08:00:00+08:00",
      "dateModified": "2015-02-05T09:20:00+08:00",
      "author": {
        "@type": "Person",
        "name": "John Doe"
       },
       "publisher": {
        "@type": "Organization",
        "name": "Google",
        "logo": {
          "@type": "ImageObject",
          "url": "https://google.com/logo.jpg"
         }
       }
    }
---
{{< detailTopImage >}}
{{< authorImage src="authorimage.jpg" name="Takafumi Noguchi" linkdin="https://www.linkedin.com/in/tnoguchi1123531" >}}
<!-- Intro  -->
前回[プロジェクトの作成]()が完了したので、今度はプロジェクトの中身を埋めていきましょう。
プロジェクトが始まると、一般的に以下のような構成でプロジェクト計画書を作成します。

  * プロジェクトの目的とゴール
  * スコープ（範囲）
  * **スケジュール**
  * **コスト**
  * **体制（リソース）**
  * コミュニケーション
  * 品質マネジメント
  * リストと対策

参照元： [PM初心者でも出来る？プロジェクト計画書の作り方](https://www.innopm.com/blog/2017/05/08/108679/#2-7)

今回は Dynamics 365 for Project Service Automation の WBS とスケジュールボードを活用して
プロジェクトの「スケジュール」「コスト」「体制（リソース）」を設定する手順をご紹介します。


## 作業テンプレートでリソースの作業日時を設定
事前準備として**作業テンプレート**を作成します。作業テンプレートは、リソースの稼働日時と祝日の設定して共通のカレンダーとして利用できる機能です。同じ環境下で作業するリソース毎に、共通の作業テンプレートを適用することで、プランニングがしやすくなります。

### 基本作業日時を設定
メニューで「リソース」を開き、テンプレートの元となるリソースの作業日時をまず設定します。
ここでは “汎用リソース” を選択しています。
<!-- Image= plan-1.png -->
{{< imagedisplay src="plan-1.png" >}}

上部メニューの「作業時間」をクリックします。
<!-- Image= plan-2.png -->
{{< imagedisplay src="plan-2.png" >}}

スケジュール表が表示されています。ここで、「設定」より「新しい週単位のスケジュール」をクリックします。
<!-- Image= plan-3.png -->
{{< imagedisplay src="plan-3.png" >}}

1週間と1日の作業時間を指定します。「作業時間の設定」をクリックします。作業時間を設定してください。
今回は 9:00 – 17:00 の8時間としました。「休憩の追加」をすると休憩時間を追加することもできます。※休憩時間は追加していません。
<!-- Image= plan-4.png -->
{{< imagedisplay src="plan-4.png" >}}

作業日数、休業日、開始日とタイムゾーンを設定したら「保存して閉じる」をクリックします。
これで基本的な作業日（月曜日から金曜日）と作業時間（9:00 – 17:00）がカレンダーに反映されます。
<!-- Image= plan-5.png -->
{{< imagedisplay src="plan-5.png" >}}

### 祝日の設定
作業日時が設定されたら、次は**祝日**を設定します。祝日は国や年により異なるので今回は 2019年の祝日だけを設定することにします。

祝日の日付を選択して「設定」より「休暇」をクリックします。
<!-- Image= plan-6.png -->
{{< imagedisplay src="plan-6.png" >}}

終日として “祝日” といれておきます。※具体的な祝日の名前をいれてもOKです。
<!-- Image= plan-7.png -->
{{< imagedisplay src="plan-7.png" >}}

スケジュールに祝日が追加されました。Outlook のような日本の祝日をインポートするような機能があれば便利ですが
現状は用意されていないので、一年分の祝日はこのように１つずつ設定してください。
<!-- Image= plan-8.png -->
{{< imagedisplay src="plan-8.png" >}}

### 作業テンプレートの作成と適用
作業日時と祝日の設定が完了したら**テンプレート**化します。
作業時間を設定したリソースにチェックをいれて「カレンダーを名前を付けて保存」をクリックします。
<!-- Image= plan-9.png -->
{{< imagedisplay src="plan-9.png" >}}

テンプレート名を入力して保存して閉じます。
<!-- Image= plan-10.png -->
{{< imagedisplay src="plan-10.png" >}}

作業時間を設定していないリソースをすべて選択して、「カレンダーの設定」をクリックします。
<!-- Image= plan-11.png -->
{{< imagedisplay src="plan-11.png" >}}

先ほど作成した作業テンプレートを選択して「Apply」をクリックします。
<!-- Image= plan-12.png -->
{{< imagedisplay src="plan-12.png" >}}

これでリソースの作業時間が設定されました。プロジェクトにおいては、複数の組織や複数の地域・国によってプロジェクトメンバーが構成されると思います。その場合は、それぞれ作業時間やカレンダーが異なる境界線ごとに作業テンプレートを作成して、各リソースに設定してください。

### プロジェクトに作業テンプレートを割り当てる
作業テンプレートは既定のテンプレートが設定されているので変更します。プロジェクトを開いて「カレンダーテンプレート」に作成した作業テンプレートを設定して保存します。
<!-- Image= plan-13.png -->
{{< imagedisplay src="plan-13.png" >}}

これで、リソースおよびプロジェクトに関係するリソースの作業日時を設定できました。次は、プロジェクトのスケジュールとコスト、そしてリソースを設定していきます。

 
## WBS でスケジュール・コスト・リソースを設定
リソースに作業テンプレートを設定したら、次はプロジェクトの「スケジュール」「コスト」「体制（リソース）」を設定します。
まずは WBS を作成してプロジェクトの開始日と終了日、各工程にアサインするリソースを設定します。

### Add a project task
※これからご紹介する手順は、Dynamics 365 for Project Service Automation の**バージョン 2 の環境上かつWeb インターフェイスから作業を行う場合の手順**です。バージョン 2 の環境かつ統一インターフェイスから WBS を編集することはできません。もし統一インターフェイスで WBS を編集する場合は Project Service をバージョン3 にアップデートする必要があります。（マイクロソフトに確認済み）

プロジェクトの上部のメニューを開いて、WBS をクリックします。
<!-- Image= plan-14.png -->
{{< imagedisplay src="plan-14.png" >}}

「＋タスクの追加」でプロジェクトの工程を追加します。
<!-- Image= plan-15.png -->
{{< imagedisplay src="plan-15.png" >}}

「インデント」をクリックすると、タスクを1つ下げることができます。
<!-- Image= plan-16.png -->
{{< imagedisplay src="plan-16.png" >}}

### スケジュールの追加
「要件定義」のタスクを複数作成しました。各タスクの「開始日」と「終了日」を設定します。
先行タスクがある場合は「前のタスク」にも値を追加します。
<!-- Image= plan-17.png -->
{{< imagedisplay src="plan-17.png" >}}

### 予定される労務コストを確認
WBS の「列の選択」をクリックすると、表示されていない列を表示できます。ここで “工数” と “予定労務コスト” にチェックを入れてください。
<!-- Image= plan-18.png -->
{{< imagedisplay src="plan-18.png" >}}

ここで WBS で追加したタスクと作業工数をもとに、プロジェクトの**予定労務コスト**が計算されます。
<!-- Image= plan-19.png -->
{{< imagedisplay src="plan-19.png" >}}

ここでは、PM のロールが、53時間が工数として必要とされています。ロールの価格はコスト価格表で設定した通りです。
<!-- Image= plan-20.png -->
{{< imagedisplay src="plan-20.png" >}}

ここでは、DeMo株式会社のコスト価格表で PM は 160 時間なので、もし 53 時間ということであれば、

(PMの原価) x (工数) / 160 =  1,000,000 円 x 53 / 160 = **331,250 円**

が予定の労務コストとなります。ここはあくまで原価なので、ここで営業価格表分の差額を請求して利益を出すことになります。

### タスクに必要なロールを設定
各タスクにリソースを割り当てます。タスクの「割り当てられたロール」をクリックして、「＋追加」でロールの行を追加します。
「ロール」と「リソース単位」を設定します。
<!-- Image= plan-21.png -->
{{< imagedisplay src="plan-21.png" >}}

もし割り当てるロールの稼働を 100% 以下にする場合は、「出荷単位」を変更します。設定完了すれば「OK」をクリックします。
<!-- Image= plan-22.png -->
{{< imagedisplay src="plan-22.png" >}}

すべてのタスクにロールを割り当てました。
この時点では、まだプロジェクトチームのメンバーが特定されていないので、ロールのみを割り当てています。

### プロジェクトチームの作成
WBS のタスクに必要なロールが設定できたら、プロジェクトチームを作成します。「プロジェクト チームの作成」をクリックします。
<!-- Image= plan-23.png -->
{{< imagedisplay src="plan-23.png" >}}

ダイアログが表示されるので「はい」をクリックします。
<!-- Image= plan-24.png -->
{{< imagedisplay src="plan-24.png" >}}

次のダイアログで PM というロールに対して “汎用リソース” が追加されたと表示されます。
これで WBS でプロジェクトのチームを作成することができました。

## スケジュールボードでチームを構成
プロジェクトの詳細画面に戻り、「チーム」を展開します。
チームには、**プロジェクトの承認者**である “作成者” と、WBS で作成した “汎用リソース” の 2 つが存在します。
<!-- Image= plan-25.png -->
{{< imagedisplay src="plan-25.png" >}}

特に何も設定していないと、プロジェクトを作成したユーザーがプロジェクトの承認者として、要求されたリソースやリソースの作業完了報告を承認する役割を持ちます。プロジェクトの承認者かどうかはメンバーの編集画面で「プロジェクト承認者」が “はい” になっているかどうかで判断できます。複数の承認者がいるプロジェクトでは、ここを設定してください。
<!-- Image= plan-26.jpg -->
{{< imagedisplay src="plan-26.jpg" >}}

### リソース要求を送信する
**汎用リソース**はまだ特定のリソースが割り当たっていない状態を指します。
そのため、プロジェクト管理者からリソースマネージャーにリソースの要求を行い、適切なリソースを割り当て作業を行います。
まずは汎用リソースをダブルクリックで開きます。
<!-- Image= plan-27.png -->
{{< imagedisplay src="plan-27.png" >}}

上部ボタンで「予約」と「要求の送信」のボタンがあります。
<!-- Image= plan-28.png -->
{{< imagedisplay src="plan-28.png" >}}

これらのボタンがリソースを割り当てる作業で利用されますが、
操作ユーザーがプロジェクトにどのような権限を持っているかで利用するボタンが異なります。

<!-- Box -->
**予約：**リソースマネージャーと呼ばれる組織のリソースを管理して、複数のプロジェクトでどのリソースをどこに割り当てるか決定できるユーザーの場合は、「予約」ボタンでプロジェクトに直接リソースを割り当てます。

**要求の送信：**プロジェクト管理者であるが、組織のリソースを自由に割り当てる権限がない場合は「要求の送信」をクリックして、リソースマネージャーと呼ばれる組織のリソース管理者に “プロジェクトにリソースが必要です” と要求を送信します。


ここではリソースを要求して、スケジュールボードで空いているリソースを割り当てる手順とします。

「要求の送信」をクリックします。コメントは任意です。「OK」をクリックして閉じます。
<!-- Image= plan-29.png -->
{{< imagedisplay src="plan-29.png" >}}

送信されたリソース要求は、メニューの「リソース要求」から確認できます。
<!-- Image= plan-30.png -->
{{< imagedisplay src="plan-30.png" >}}

先ほど送信した要求があるのでチェックをいれて「リソースの検索」をクリックします。
<!-- Image= plan-31.png -->
{{< imagedisplay src="plan-31.png" >}}

**スケジュールボード**が開き、要求に合ったリソースがいるかどうか表示されます。左パネルが「フィルター」になっており、このフィルター条件にあったリソースが表示されます。今回は Test Taro さんが空いているようなので予約をします。名前の個所をクリックすると予約画面が右パネルに表示されます。「予約の状態」で “本” として 「予約」ボタンをクリックします。これで予約は確定します。
<!-- Image= plan-32.png -->
{{< imagedisplay src="plan-32.png" >}}

予約を確定すると、このように空き時間が０時間になったのがわかります。
<!-- Image= plan-33.png -->
{{< imagedisplay src="plan-33.png" >}}

先ほどのプロジェクトのチームを確認すると、”汎用リソース” が Test Taro に代わっていることがわかります。
<!-- Image= plan-34.png -->
{{< imagedisplay src="plan-34.png" >}}

このようにプロジェクトにリソースを割り当てていきます。もし WBS でタスクを追加して別のリソースが必要になれば同じ手順でリソースを確保していきます。もちろん WBS でタスクを増やすと、予定の労務コストも増えるので、営業案件で作成した見積もりの金額を上回らないように注意が必要です。

## 最後に
ここでは、プロジェクト作成後、WBS やスケジュールボードで「スケジュール」「コスト」「体制」を設定しました。実際に操作をしているとスケジュールボードの動作やリソースの要求の手順のところ少し気になる動作も見受けられたので、このあたりも調査を進め、また共有できたらと思います。

また、上述した “統一インターフェイスで WBS を編集する” 件について、Project Service Automation のバージョン２から３へアップデートして、その後動作確認をしたら、また情報を共有します。    
&nbsp;